!  PROGRAM RELASER
!
!  ***** ORIGINAL VERSION 1.0
!  THE ORIGINAL VERSION OF THIS PROGRAM WAS WRITTEN BY CLAYTON H. BAIR.
!  THIS PROGRAM WAS BEGUN ON JUNE 5, 1989.  AT THAT TIME ABSOFT'S 
!  MacFortran V2.4 WAS INSTALLED ON CLAY'S MAC II.  TURN AROUND
!  ON THE VAX WAS SO... SLOW... THAT IT SEEMED PRACTICAL TO
!  CONSIDER THIS ALTERNATIVE.
! 
!  ***** VERSION 2.0
!  THIS PROGRAM HAS BEEN RESTRUCTURED BY BRIAN M. WALSH - JUNE,2002
!  CONVERTED FROM MacFortran2.4 to MPW FORTRAN ON A MAC
!  THIS VERSION CONTAINS MOSTLY REPLACEMENT OF OUTDATED FORTRAN COMMANDS.
!  MENU INPUT ROUTINES WERE ALSO REWRITTEN BECAUSE OF OUTDATED FORTRAN CODE.
!
!  ***** VERSION 2.1
!
!  CHANGES IMPLEMENTED IN THE CODE JUNE, 2002 - AUGUST 2002
!  THE ORIGINAL 'DOLOOPS.IN' FILE HAS BECOME LASPAR.DAT WITH ADDITIONS
!  TO INCLUDE THE PARAMETERS THAT WERE PREVIOUSLY ONLY AVAILABLE IN THE
!  PROGRAM INPUT MENUS. THE ORIGINAL RELASER.DAT HAS BECOME 'SPECPAR.DAT'
!  AND REMAINS UNCHANGED IN CONTENT.
!  SPECPAR.DAT CONTAINS SPECTROSCOPIC INPUT, LASPAR.DAT CONTAINS LASER INPUT
!
!  ***** VERSION 2.2-2.4
!  CHANGES WERE IMPLEMENTED IN THE CODE: AUGUST 2002 - MARCH 2003
!  (1-R) HAS BEEN CHANGED TO LN(R), SINCE (1-R)~Ln(R) ONLY TRUE AT LARGE R 
!  RESONATOR TYPE (LINEAR OR RING) OPTION HAS BEEN ADDED TO PROGRAM.
!  C/2L TERMS HAVE BECOME C/(RESTYPE*L) FOR LINEAR OR RING OPTION
!  WHERE RESTYPE=1 FOR RING CAVITY AND =2 FOR A LINEAR CAVITY.
!  SUBROUTINE RATEEQ IS NEW - PREVIOUSLY THIS CODE WAS PART OF CRUNCH
!     (CRUNCH WAS JUST TOO BIG, SO I SEPARATED OUT THE RATE EQUATIONS...
!      CRUNCH IS STILL A MESS, BUT BEST I CAN DO FOR NOW.)
!
!  ***** VERSION 2.4 CONVERSION TO PC 
!  PROGRAM CONVERTED FROM MPW FORTRAN ON A MAC TO ABSOFT PRO FORTRAN 7.5
!  PC BY PATRICIA CROSS IN APRIL, 2003
!  ROUTINES REMOVED ARE:
!     CLR()
!     THEDATE(DAT)
!     THETIME(TIM)
!     ...CAN DATE AND TIME ROUTINES BE CODED GENERIC FOR PC AND MAC?
!  ROUTINES ADDED APPEAR AT END OF PROGRAM:
!     Subroutine my_FillString(string1, string2)
!     OFName(lshort,lout,icase)
!  OTHER PATRICIA CROSS ADDITIONS APPEAR IN lower case IN THE CODE
!
!  ***** VERSION 2.5
!  MAJOR CLEANUP COMPLEATED BY BRIAN M. WALSH IN APRIL, 2003
!  REMOVED ALL REMNANTS OF OLD COMMENTED OUT CODE...HAD TO BE DONE!
!     (ANY REMAINING COMMENTED OUT LINES ARE MY CURRENT REMNANTS) 
!  REMOVED SOME INACTIVE SUBROUTINES AND THEIR CALLS:
!     CALL TMTMXFR (TOTLCON(2),BILINRT(3),BILINRT(4),BILINRT(5), BILINRT(6))
!     CALL TMHOXFR (TOTLCON(1),TEMPER,BILINRT(1),BILINRT(2))
!     CALL TM3F4DK (TOTLCON(2),TEMPER,DKRATE(2))
!     CALL HO5I7DK (TOTLCON(1),TEMPER,DKRATE(1))
!  TRIED TO CLEAN UP LINE NUMBERING
!  ADDED EXTENSIVE COMMENTING TO ENTIRE PROGRAM, A MAJOR EFFORT!
!
!  ***** VERSION 2.6
!  CHANGES IMPLEMENTED IN JUNE, 2003
!  NEEDED TO CLARIFY DIFFERENCE BETWEEN END PUMP AND SIDE PUMP. ALSO,
!  THERE IS SOME CONFUSION REGARDING MODE RADIUS AND ROD RADIUS, HENCE...
!  CHANGED CAVDIA TO CMRAD, CAVAREA TO CMAREA WITH CMAREA=PI*CMRAD*CMRAD
!  CHANGED RODDIA TO RODRAD AND CREATED PABSL IN PLACE OF RODDIA.
!  (PREVIOUSLY, PROGRAM USED RODDIA FOR PUMP ABSORPTION LENGTH. I SEPARATED
!  PUMP ABSORPTION LENGTH, PABSL, FROM ROD RADIUS, RODRAD)
!  ...AND ADDED:
!      IF RESONATOR IS SIDE PUMPED THEN PABSL=2*RODRAD
!      IF RESONATOR IS END PUMPED THEN PABSL=RODL
!  ...AND CHANGED
!      W1=PUMPETA*PUMPE*(PUMPLAM/HC)/(CAVAREA*RODL)
!  TO  W1=PUMPETA*PUMPE*(PUMPLAM/HC)/(RODAREA*RODL)  
!      RODVOL = CAVDIA * RODL * PMPALGN
!  TO  RODVOL = RODAREA * RODL * PMPALGN
!      OPTVOL = CAVAREA * OPTLNG(I) * PMPALGN
!  TO  OPTVOL = CMAREA * OPTLNG(I) * PMPALGN
!
!  ***** VERSION 2.7.1 May 17, 2009
!  HAVE MOVED TO ABSOFT PRO FORTRAN ON THE MAC -
!  CHANGED .OUT EXTENSION TO .REL EXTENSION FOR REASONS TO NOT CONFLICT
!  WITH GNOM.OUT UNIX FILE TYPES
!  June 2-3, 2009
!  ...ADDED AN EXTRA MENU ITEM (6) FOR A Q-SWITCH OPEN INTERVAL TIME - IQT
!  ...AND CHANGED (IN Q-SWITCH ROUTINE):
!       IF (TQ-T .GT. 0.0D0) R8PRIME = 1.0D8
!  TO
!       IF ((TQ .GT. 0.00D0) .AND. (T .LT. TQ)) R8PRIME = 1.0D8
!       IF ((TQI .GT. 0.0D0) .AND. (T .GT. TQ+TQI)) R8PRIME = 1.0D8          
!  THIS CAN BE ADAPTED LATER FOR MULTIPLE PULSING OR REPETITVE QS
!
!  ADDED LOOP AT END OF PROGRAM TO RUN ADDITIONAL SIMULATIONS
!
!  CHANGED FORMAT(1PE10.4,11(A2,E10.4)) TO FORMAT(1PE11.5,11(A2,E11.5))
!  TO EXTEND DIGITS FROM 5 TO 6 - CORRECTS PROBLEM FORMATTING TIME
!
! ***** VERSION 2.7.2 June 15, 2018
!  PREVIOUS MODIFICATIONS WERE MADE FOR END PUMP (1) AND SIDE PUMP (2).
!  MODIFICATIONS WERE SUFFICIENT, BUT SOME RESIDUAL PROBLEM FOR END PUMP REMAINS.
!  SPECIFICALLY, LASER ENERGY FOR END PUMP CHANGES WITH ROD RADIUS. IT SHOULD NOT.  
!  NOT A MAJOR FIX, BUT TOOK TIME TO TRACK IT DOWN. SOLUTION - CMAREA VS RODAREA
!  ADDITIONAL QUALIFIERS HAVE BEEN ADDED AS FOLLOWS
!
!  IN FRONT END OF PROGRAM, REPLACED
!       W1=PUMPETA*PUMPE*(PUMPLAM/HC)/(RODVOL)
!  WITH 
!       IF (PUMPTYPE .EQ. 1) W1=PUMPETA*PUMPE*(PUMPLAM/HC)/(CMAREA*RODL)
!       IF (PUMPTYPE .EQ. 2) W1=PUMPETA*PUMPE*(PUMPLAM/HC)/(RODAREA*RODL)
!
!  IN SUBROUTINE CLEANUP, REPLACES
!       B=RODAREA/(4.0D0*PI*OPTLNG(I)*OPTLNG(I))
!  WITH 
!       IF (PUMPTYPE .EQ. 1) B=CMAREA/(4.0D0*PI*OPTLNG(I)*OPTLNG(I))
!       IF (PUMPTYPE .EQ. 2) B=RODAREA/(4.0D0*PI*OPTLNG(I)*OPTLNG(I))
!
!  IN SUBROUTINE MOREDUMP, REPLACED
!       RODVOL = RODAREA * RODL * PMPALGN
!  WITH 
!       IF (PUMPTYPE .EQ. 1) RODVOL = CMAREA * RODL * PMPALGN
!       IF (PUMPTYPE .EQ. 2) RODVOL = RODAREA * RODL * PMPALGN
!  ***** VERSION 2.7.3 JUNE 18,2018
!  MANUALLY IMPLEMENTED CHANGES MADE BY BRIAN M. WALSH IN RELASER272
!  COMPILED SUCCESSFULLY, BUT IN END PUMPING PROBLEM WITH 
!  WIDTH INCREASING AS EOUTLAM1 IS INCREASING STILL 
!  PERSISTS. ALSO PROBLEM WITH TAKING OUT TM AND GETTING ERRORS
!  STILL PERSISTS.  

!  ***** VERSION 3.0 FUTURE PLANS
!  Make a GUI interface using Winteracter or convert to another language for GUI. 
!  